<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cube Layout Editor — Interactive</title>
<style>
  :root{
    --bg:#071426;
    --panel-grad: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    --border: rgba(255,255,255,0.06);
    --muted:#9fbfdc;
    --accent:#4cc1ff;
    --cube-size:336px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#031426,#071426);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#eaf6ff;overflow:hidden}
  /* Canvas */
  .canvas { position:relative; width:100vw; height:calc(100vh - 160px); padding:28px; display:flex; gap:18px; }
  /* Editable box base */
  .editable { position:absolute; background:var(--panel-grad); border:1px solid var(--border); border-radius:12px; padding:14px; box-shadow:0 18px 46px rgba(0,0,0,0.5); touch-action:none; user-select:none; }
  .editable .title { font-weight:700; margin-bottom:6px }
  .editable .meta { color:var(--muted); font-size:13px }

  /* Resize handles */
  .handle { width:12px; height:12px; background:var(--accent); border:2px solid #fff; border-radius:50%; position:absolute; opacity:0; transition:opacity .12s; z-index:9 }
  .editable:hover .handle { opacity:1 }
  .handle.tl{ left:-8px; top:-8px; cursor:nwse-resize }
  .handle.tr{ right:-8px; top:-8px; cursor:nesw-resize }
  .handle.bl{ left:-8px; bottom:-8px; cursor:nesw-resize }
  .handle.br{ right:-8px; bottom:-8px; cursor:nwse-resize }
  .handle.mid-t{ left:50%; top:-8px; transform:translateX(-50%); cursor:n-resize }
  .handle.mid-b{ left:50%; bottom:-8px; transform:translateX(-50%); cursor:s-resize }
  .handle.mid-l{ left:-8px; top:50%; transform:translateY(-50%); cursor:w-resize }
  .handle.mid-r{ right:-8px; top:50%; transform:translateY(-50%); cursor:e-resize }

  /* Panels (starter positions) */
  #titlePanel{ left:28px; top:28px; width:360px; height:260px; }
  #descPanel{ left:28px; top:312px; width:360px; height:320px;}
  #imagePanel{ right:28px; top:28px; width:56vw; height:76vh; display:flex; align-items:center; justify-content:center; text-align:center; padding:24px; }

  /* Cube container */
  .cube-wrap { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:var(--cube-size); height:var(--cube-size); pointer-events:auto; }
  .scene { width:100%; height:100%; perspective:1200px; position:relative; }
  .cube { width:100%; height:100%; position:relative; transform-style:preserve-3d; transform:translateZ(-140px) rotateX(-10deg) rotateY(0deg); transition:transform .08s linear; }
  .face { position:absolute; left:0; top:0; width:100%; height:100%; border-radius:12px; background:var(--panel-grad); border:1px solid var(--border); display:flex; flex-direction:column; align-items:center; justify-content:center; backface-visibility:hidden; box-shadow:0 10px 36px rgba(0,0,0,0.6); cursor:grab }
  .accent { position:absolute; left:0; top:0; bottom:0; width:8px; border-top-left-radius:12px; border-bottom-left-radius:12px }
  .front{ transform:rotateY(0deg) translateZ(calc(var(--cube-size)/2)); }
  .right{ transform:rotateY(90deg) translateZ(calc(var(--cube-size)/2)); }
  .back{ transform:rotateY(180deg) translateZ(calc(var(--cube-size)/2)); }
  .left{ transform:rotateY(270deg) translateZ(calc(var(--cube-size)/2)); }
  .top{ transform:rotateX(90deg) translateZ(calc(var(--cube-size)/2)); }
  .bottom{ transform:rotateX(-90deg) translateZ(calc(var(--cube-size)/2)); }

  /* Projects bar (bottom of canvas area) */
  .projects { position:absolute; left:50%; transform:translateX(-50%); bottom:8px; display:flex; gap:12px; z-index:8; }
  .proj-btn { width:140px; height:72px; border-radius:10px; background:var(--panel-grad); border:1px solid var(--border); display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; }
  .proj-btn strong{ font-size:18px }

  /* Change log area */
  .change-log { height:160px; background:linear-gradient(180deg,#020617,#071426); border-top:1px solid rgba(255,255,255,0.03); padding:12px; display:flex; gap:12px; align-items:stretch; }
  .log { flex:1; background:#071425; border:1px solid var(--border); border-radius:8px; padding:8px; color:var(--muted); font-family:monospace; font-size:13px; overflow:auto; white-space:pre-wrap }
  .controls { width:260px; display:flex; flex-direction:column; gap:8px }
  .controls button, .controls input { background:transparent; border:1px solid var(--border); color:var(--muted); padding:8px; border-radius:8px; cursor:pointer }
  .controls textarea { width:100%; height:80px; resize:vertical; background:#071425; border:1px solid var(--border); color:var(--muted); padding:8px; border-radius:6px; font-family:monospace }

  /* small helper */
  .hidden{ display:none }
</style>
</head>
<body>
  <div class="canvas" id="canvas" aria-label="Design canvas">
    <!-- editable panels -->
    <div id="titlePanel" class="editable" data-name="titlePanel">
      <div class="handle tl"></div><div class="handle tr"></div><div class="handle bl"></div><div class="handle br"></div>
      <div class="title" contenteditable="true">Minesweeper</div>
      <div class="meta" contenteditable="true">Interactive tile-based puzzle</div>
    </div>

    <div id="descPanel" class="editable" data-name="descPanel">
      <div class="handle tl"></div><div class="handle tr"></div><div class="handle bl"></div><div class="handle br"></div>
      <p contenteditable="true">Classic minesweeper rebuilt with modern UI. Drag the cube to rotate projects, or click the numbered buttons below to jump to a project.</p>
    </div>

    <div id="imagePanel" class="editable" data-name="imagePanel">
      <div class="handle tl"></div><div class="handle tr"></div><div class="handle bl"></div><div class="handle br"></div>
      <div style="color:var(--muted)">Preview panel — drop images here</div>
    </div>

    <!-- cube wrap is movable/resizable too -->
    <div id="cubeWrap" class="editable cube-wrap" data-name="cubeWrap" style="left:50%;top:50%;width:var(--cube-size);height:var(--cube-size);">
      <div class="handle tl"></div><div class="handle tr"></div><div class="handle bl"></div><div class="handle br"></div>
      <div class="scene" id="scene">
        <div class="cube" id="cube" role="application" aria-label="interactive cube">
          <div class="face front" data-slot="front"><div class="accent" style="background:#e74c3c"></div><h3>Project 1</h3><div class="meta">Interactive tile puzzle</div></div>
          <div class="face right" data-slot="right"><div class="accent" style="background:#27ae60"></div><h3>Project 2</h3><div class="meta">Utility tool</div></div>
          <div class="face back" data-slot="back"><div class="accent" style="background:#9b59b6"></div><h3>Project 3</h3><div class="meta">Algorithmic art</div></div>
          <div class="face left" data-slot="left"><div class="accent" style="background:#1abc9c"></div><h3>Project 4</h3><div class="meta">UX experiments</div></div>
          <div class="face top" data-slot="top"><div class="accent" style="background:#f39c12"></div><h3>Project 5</h3><div class="meta">Extra face</div></div>
          <div class="face bottom" data-slot="bottom"><div class="accent" style="background:#34495e"></div><h3>Project 6</h3><div class="meta">Extra face</div></div>
        </div>
      </div>
    </div>

    <!-- projects bar -->
    <div class="projects" id="projectsBar" aria-hidden="false"></div>
  </div>

  <!-- change log area -->
  <div class="change-log" id="changeLogArea">
    <div class="log" id="changeLog" aria-live="polite" role="status">Change log (actions will appear here)...</div>
    <div class="controls">
      <button id="exportBtn">Copy changes</button>
      <button id="resetBtn">Reset layout</button>
      <label style="font-size:12px;color:var(--muted);margin-top:8px">Manual command (paste to apply)</label>
      <textarea id="manualCmd" placeholder="Paste a change list here to apply (not implemented in demo)"></textarea>
    </div>
  </div>

<script>
/* Editor with drag/resize for any .editable and a change log that records actions.
   - You can drag any block, resize via corner handles.
   - Cube rotation preserved from previous file: drag the cube interior to rotate on Y.
   - Every change appends a single-line, machine-readable entry to the change log.
   - Export button copies the log contents.
*/

/* ---------- Utilities ---------- */
const logEl = document.getElementById('changeLog');
function appendLog(entry){
  const ts = new Date().toISOString();
  logEl.textContent += `\n[${ts}] ${entry}`;
  logEl.scrollTop = logEl.scrollHeight;
}
function px(n){ return `${Math.round(n)}px` }
function parsePx(v){ return parseFloat(v.replace('px','')) || 0 }

/* ---------- Editable drag/resize core ---------- */
const editables = Array.from(document.querySelectorAll('.editable'));
let active = null;
let mode = null; // 'move' or 'resize'
let start = null;

editables.forEach(el=>{
  // make handles interactive
  const handles = Array.from(el.querySelectorAll('.handle'));
  handles.forEach(h=>{
    h.addEventListener('pointerdown', (ev)=>{
      ev.stopPropagation(); ev.preventDefault();
      active = el;
      mode = 'resize';
      start = { x: ev.clientX, y: ev.clientY, rect: el.getBoundingClientRect(), handle: Array.from(el.querySelectorAll('.handle')).indexOf(h) };
      el.classList.add('dragging');
      try{ h.setPointerCapture(ev.pointerId) }catch(e){}
    });
  });

  // move by dragging the element body (not handles)
  el.addEventListener('pointerdown', (ev)=>{
    // ignore if clicked on handle
    if(ev.target.classList.contains('handle')) return;
    active = el;
    mode = 'move';
    start = { x: ev.clientX, y: ev.clientY, rect: el.getBoundingClientRect() };
    el.classList.add('dragging');
    try{ el.setPointerCapture(ev.pointerId) }catch(e){}
  });
});

// global pointermove/up
window.addEventListener('pointermove', (ev)=>{
  if(!active || !start) return;
  ev.preventDefault();
  const dx = ev.clientX - start.x;
  const dy = ev.clientY - start.y;
  if(mode === 'move'){
    const newLeft = start.rect.left + dx;
    const newTop  = start.rect.top + dy;
    // constrain within body
    const bodyRect = document.body.getBoundingClientRect();
    const w = start.rect.width, h = start.rect.height;
    const left = Math.max(8, Math.min(newLeft, bodyRect.width - w - 8));
    const top  = Math.max(8, Math.min(newTop, bodyRect.height - h - 180)); // keep above log area
    active.style.left = px(left);
    active.style.top  = px(top);
  } else if(mode === 'resize'){
    // which handle?
    const handleIndex = start.handle;
    const rect = start.rect;
    let newLeft = rect.left, newTop = rect.top, newW = rect.width, newH = rect.height;
    // Four corners only handleIndex 0..3 mapping to tl,tr,bl,br
    if(handleIndex === 0){ // tl
      newLeft = rect.left + dx;
      newTop  = rect.top + dy;
      newW = rect.width - dx;
      newH = rect.height - dy;
    } else if(handleIndex === 1){ // tr
      newTop = rect.top + dy;
      newW = rect.width + dx;
      newH = rect.height - dy;
    } else if(handleIndex === 2){ // bl
      newLeft = rect.left + dx;
      newW = rect.width - dx;
      newH = rect.height + dy;
    } else if(handleIndex === 3){ // br
      newW = rect.width + dx;
      newH = rect.height + dy;
    }
    // enforce minimum
    const minW = 80, minH = 60;
    if(newW < minW) newW = minW;
    if(newH < minH) newH = minH;
    // constrain within body
    const bodyRect = document.body.getBoundingClientRect();
    newLeft = Math.max(8, Math.min(newLeft, bodyRect.width - newW - 8));
    newTop  = Math.max(8, Math.min(newTop, bodyRect.height - newH - 180));
    active.style.left = px(newLeft);
    active.style.top  = px(newTop);
    active.style.width = px(newW);
    active.style.height = px(newH);
  }
});

window.addEventListener('pointerup', (ev)=>{
  if(!active || !start) return;
  // finalize
  const rect = active.getBoundingClientRect();
  const name = active.dataset.name || active.id || 'editable';
  if(mode === 'move'){
    appendLog(`${name} moved to left:${Math.round(rect.left)}px top:${Math.round(rect.top)}px width:${Math.round(rect.width)}px height:${Math.round(rect.height)}px`);
  } else if(mode === 'resize'){
    appendLog(`${name} resized to left:${Math.round(rect.left)}px top:${Math.round(rect.top)}px width:${Math.round(rect.width)}px height:${Math.round(rect.height)}px`);
  }
  active.classList.remove('dragging');
  try{ ev.target.releasePointerCapture?.(ev.pointerId); }catch(e){}
  active = null; mode = null; start = null;
});

/* ---------- Cube rotation (drag inside cube to rotate) ---------- */
const scene = document.getElementById('scene');
const cube = document.getElementById('cube');
let isDown = false, startX=0, startRot=0, rotY=0;
scene.addEventListener('pointerdown', (e)=>{
  // only start if pointer in cube area (not on handles)
  if(e.target.closest('.handle')) return;
  isDown = true; startX = e.clientX; startRot = rotY;
  try{ scene.setPointerCapture(e.pointerId) }catch(e){}
});
scene.addEventListener('pointermove', (e)=>{
  if(!isDown) return;
  const dx = e.clientX - startX;
  rotY = startRot + dx * 0.35; // sensitivity
  cube.style.transform = `translateZ(-140px) rotateX(-10deg) rotateY(${rotY}deg)`;
});
scene.addEventListener('pointerup', (e)=>{
  if(!isDown) return;
  isDown = false;
  appendLog(`cube rotated to rotateY:${Math.round(rotY)}deg`);
  try{ scene.releasePointerCapture(e.pointerId) }catch(e){}
});

/* ---------- Build bottom projects buttons (click to center cube) ---------- */
const projects = [
  {title:"Minesweeper", subtitle:"Interactive tile puzzle", desc:"Classic minesweeper rebuilt", url:"#", color:"#e74c3c"},
  {title:"Poly Weave", subtitle:"Generative geometry", desc:"Visual experiments", url:"#", color:"#9b59b6"},
  {title:"Grid Tools", subtitle:"UI grid utilities", desc:"Small toolkit", url:"#", color:"#1abc9c"},
  {title:"UX Micro", subtitle:"Microinteractions", desc:"Playful UI", url:"#", color:"#f39c12"},
  {title:"Data Viz", subtitle:"Visual playground", desc:"Charts & algos", url:"#", color:"#27ae60"},
  {title:"Experiments", subtitle:"Misc", desc:"Portfolio tests", url:"#", color:"#4cc1ff"}
];
const projectsBar = document.getElementById('projectsBar');
function renderProjects(){ projectsBar.innerHTML=''; projects.forEach((p,i)=>{
  const b = document.createElement('div'); b.className='proj-btn'; b.innerHTML = `<strong>${i+1}</strong><span style="font-size:12px;color:var(--muted);">${p.title}</span>`;
  b.addEventListener('click', ()=> centerCubeOnIndex(i));
  projectsBar.appendChild(b);
})}
renderProjects();

function centerCubeOnIndex(i){
  // map index to face: 0 front (0deg), 1 right (-90), 2 back (-180), 3 left (-270)
  const faceIndex = i % 4;
  const target = -faceIndex * 90;
  animateRotationTo(target);
  appendLog(`centerCube: projectIndex:${i} targetRotateY:${target}deg`);
}
function animateRotationTo(targetDeg){
  const from = rotY;
  const total = targetDeg - (from % 360);
  const dur = 420;
  const start = performance.now();
  function step(now){
    const t = Math.min(1, (now - start)/dur);
    const eased = 1 - Math.pow(1-t,3);
    rotY = from + total * eased;
    cube.style.transform = `translateZ(-140px) rotateX(-10deg) rotateY(${rotY}deg)`;
    if(t < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

/* ---------- Export / Reset UI ---------- */
document.getElementById('exportBtn').addEventListener('click', ()=>{
  const txt = logEl.textContent;
  navigator.clipboard?.writeText(txt).then(()=> appendLog('exported log to clipboard'), ()=> appendLog('copy failed'));
});
document.getElementById('resetBtn').addEventListener('click', ()=>{
  // reset positions to initial layout (simple approach)
  document.getElementById('titlePanel').style.left = '28px';
  document.getElementById('titlePanel').style.top = '28px';
  document.getElementById('titlePanel').style.width = '360px';
  document.getElementById('titlePanel').style.height = '260px';

  document.getElementById('descPanel').style.left = '28px';
  document.getElementById('descPanel').style.top = '312px';
  document.getElementById('descPanel').style.width = '360px';
  document.getElementById('descPanel').style.height = '320px';

  document.getElementById('imagePanel').style.right = '28px';
  document.getElementById('imagePanel').style.top = '28px';
  document.getElementById('imagePanel').style.width = '56vw';
  document.getElementById('imagePanel').style.height = '76vh';

  const cw = document.getElementById('cubeWrap');
  cw.style.left = '50%'; cw.style.top = '50%'; cw.style.width = getComputedStyle(document.documentElement).getPropertyValue('--cube-size') || '336px';
  cw.style.height = getComputedStyle(document.documentElement).getPropertyValue('--cube-size') || '336px';
  cube.style.transform = `translateZ(-140px) rotateX(-10deg) rotateY(0deg)`;
  rotY = 0;
  appendLog('layout reset to defaults');
});

/* ---------- Simple persistence of contenteditable text to log on blur ---------- */
Array.from(document.querySelectorAll('[contenteditable]')).forEach(el=>{
  el.addEventListener('blur', ()=>{
    appendLog(`${el.closest('.editable')?.dataset?.name || el.id || 'text'} edited: "${el.textContent.trim().replace(/\s+/g,' ')}"`);
  });
});

/* ---------- Initialization logs ---------- */
appendLog('editor ready — drag any panel or resize with handles. Drag cube area to rotate. Use project buttons to center faces.');
appendLog('Tip: every move/resize is recorded here; copy changes and paste them into chat to tell me exactly what you moved.');
</script>
</body>
</html>
